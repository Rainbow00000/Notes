# 《编译原理》笔记

## 第二章 一个简单的语法制导翻译器

- 语法（syntax）描述了该语言的程序的正确形式

- 语义（semantics）定义了程序的含义

- 语法制导翻译（syntax-directed translation）一种面向文法的编译技术

- 一个编译器的前端模型

    ```
    源程序           词法单元
    ---->|词法分析器|------->|语法分析器|
              ^      ->         |
              |     /           | 语法分析树
              v   <-            v
           |符号表|  <->   |中间代码生成器|
                                |
                                | 三地址代码
                                v
    ```

- 词法单元（token）

- 抽象语法树（abstract syntax tree）

- 语法书（syntax tree）

- 语法

    *stmt* → **if** ( *expr* ) *stmt* **else** *stmt*

    - 其中箭头（→）读作“可以具有如下形式”，这样的规则称为**产生式（production）**

    - 其中 **if** 和括号这样的词法元素称为**终结符号（terminal）**

    - 其中 *expr* 和 *stmt* 这样的变量表示终结符号的序列，称为**非终结符号（nonterminal）**

- 文法定义

    一个 **上下文无关文法（context-free grammar）** 由四个元素组成

    1. 一个**终结符号**集合，他们有时也称为“词法单元”
    2. 一个**非终结符号**集合，他们有时也称为“语法变量”
    3. 一个**产生式**集合，其中每个产生式包括一个称为**产生式头部**或**左部**的非终结符号，一个箭头，和一个称为**产生式体**或**右部**的由终结符号及非终结符号组成的序列
    4. 指定一个非终结符号为**开始**符号

- 语法分析（parsing）的任务是：接受一个终结符号串作为输入，找出从文法的开始符号推导出这个串的方法。

- 语法分析树（parse tree）

    1. 根结点的标号为文法的开始符号
    2. 每个叶子结点的标号为一个终结符号或ε
    3. 每个内部结点的标号为一个非终结符号
    4. 如果非终结符号 A 是某个内部结点的标号，并且它的子结点的标号从左至右分别为 X<sub>1</sub>，X<sub>2</sub>，...，X<sub>n</sub>，那么必然存在产生式 A → X<sub>1</sub>X<sub>2</sub>...X<sub>n</sub>，其中 X 既可以是终结符号，也可以是非终结符号。作为一个特殊情况，如果 A→ε 是一个产生式，那么一个标号为 A 的结点可以只有一个标号为 ε 子结点

- 二义性（ambiguous）：一个文法可能有多棵语法分析树能够生成同一个给定的终结符号串

- 使用运算符的结合性以及运算符的优先级来解决二义性

- 语法制导翻译相关概念：

    - 属性（attribute）：属性表示与某个程序构造相关的任意的量
    - （语法制导的）翻译方案（translation scheme）：翻译方案是一种将程序片段附加到一个文法的各个产生式上的表示法
    - 语法制导定义（syntax-directed definition）把①每个文法符号和一个属性集合相关联，并且把②每个产生式和一组语义规则（semantic rule）相关联

- 递归下降分析方法（recursive-descent parsing）是一种自顶向下的语法分析方法，它使用一组递归过程来处理输入。文法的每个非终结符都有一个相关联的过程

- 预测分析法（predictive parsing）：在预测分析法中，各个非终结符号对应的过程中的控制流可以由向前看符号无二义地确定

- 预测分析器（predictive parser）：

    一个预测分析器程序由各个非终结符对应的过程组成。对应于非终结符 A 的过程完成以下两个任务：

    1. 检查向前看符号，决定使用 A 的哪个产生式。如果一个产生式的体为 α (这里 α 不是空串 ε) 且向前看符号在 FIRST（α）中，那么就选择这个产生式。对于任何向前看符号，如果两个非空的产生式体之间存在冲突，我们就不能对这种文法使用预测语法分析。另外，如果 A 有 ε 产生式，那么只有向前看符号不在 A 的其他产生式体的 FIRST 集合中时，才会使用 A 的 ε 产生式
    2. 然后，这个过程模拟被选中产生式的体。也就是说，从左边开始逐个“执行”此产生式体中的符号

- 抽象语法树（abstract syntax tree）也简称为语法树（syntax tree），在某种程度上和语法分析树相似。但是在抽象语法树中，内部结点代表的是程序构造；而在语法分析树中，内部结点代表的是非终结符号。抽象语法树中会省略一些辅助结点。有时也称语法分析树为具体语法树（concrete syntax tree），而相应的文法被称为该语言的具体语法（concrete syntax）

- 使用右递归来消除左递归

    ```
    A → Aα | β

    等价于

    A → βR
    R → αR | ε
    ```
